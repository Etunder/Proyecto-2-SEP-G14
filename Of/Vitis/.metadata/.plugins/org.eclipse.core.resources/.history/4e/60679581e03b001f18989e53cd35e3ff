#include "globals.h"
#include "utils.h"

int estado1_handler(int *opcion, int *cancion, int *wait)
{
    if (*cancion == 0) {
        if (atoi(joyy) > 650) {
            if (*opcion > 1) {
                --(*opcion);
            } else {
                *opcion = 3;
            }
        } else if (atoi(joyy) < 350) {
            if (*opcion < 3) {
                ++(*opcion);
            } else {
                *opcion = 1;
            }
        }

        draw_song_menu(*opcion);

        delay_ms(100);

        if (atoi(joyx) > 650 && *wait == 1) {
            LCD_Clear(GUI_BACKGROUND);
            *cancion = *opcion;
            *opcion = 1;
            *wait = 0;
        }

        *wait = 1;

    } else {
        play_song(*cancion);

        if (atoi(joyx) < 350) {
            LCD_Clear(GUI_BACKGROUND);
            *cancion = 0;
        }

        if (750 > atoi(acx) + atoi(acx) || atoi(acx) + atoi(acx) > 1250) {
            LCD_Clear(GUI_BACKGROUND);
            if (*cancion >= sizeof(song_titles) / sizeof(song_titles[0])) {
                *cancion = 1;
            } else {
                ++(*cancion);
            }
        }
    }

    if (atoi(joyx) < 350 && *cancion == 0) {
        LCD_Clear(GUI_BACKGROUND);
        return 0;
    }

    return 1;
}
